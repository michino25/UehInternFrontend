@page "/uehlogin"
@layout EmptyLayout

@code {
    public string? api;
    protected override void OnInitialized()
    {
        api = Configuration["apiBackend"];
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JS.InvokeVoidAsync("executeLoginScript");
        }
    }

    private LoginRequest loginRequest = new LoginRequest();

    private async Task HandleValidSubmit()
    {
        if (loginRequest.Username == "thinhdt")
        {
            NavigationManager.NavigateTo("/LoginCallback/?t=gv");
        }
        else
        if (loginRequest.Username == "hienphan")
        {
            NavigationManager.NavigateTo("/LoginCallback/?t=admin");
        }
        else
        {
            await JS.InvokeVoidAsync("showElement", "div.validation-summary-errors");
        }
    }
    
}

<PageTitle>UEH | Đăng nhập</PageTitle>

<div class="limiter">
    <div class="container-login100">
        <div class="wrap-login100">
            <EditForm Model="@loginRequest" OnValidSubmit="@HandleValidSubmit" class="login100-form validate-form">
                <img src="./images/ueh-logo.png" alt="UEH" style="width: 130px;display: block; margin-left: auto; margin-right: auto;">
                <br>
                <h3
                    style=" text-align: center; text-transform: uppercase; margin-bottom: 10px; color: #000000; font-size: 20px; font-weight: bold; ">
                    Dành cho cán bộ viên chức
                </h3>

                <div class="wrap-input100 validate-input txtemail" data-validate="Email có dạng: tendangnhap@ueh.edu.vn">
                    <InputText autofocus="true" class="input100" data-val="true" data-val-required="The username field is required." 
                        id="txtusername" name="username" required="required" type="text" @bind-Value="@loginRequest.Username" />

                    <span class="focus-input100"></span>
                    <span class="label-input100">Tên đăng nhập</span>
                </div>

                <div class="wrap-input100 validate-input uselocalaccount" data-validate="Mật khẩu không được để trống">
                    <InputText class="input100" data-val="true" data-val-required="The password field is required."
                        id="password" name="password" type="password" @bind-Value="@loginRequest.Password"  />
            
                    <span class="focus-input100"></span>
                    <span class="label-input100">Mật khẩu</span>
                </div>

                <div class="validation-summary-errors hidden">
                    <ul>
                        <li>Sai tên đăng nhập hoặc mật khẩu.</li>
                    </ul>
                </div>

                <div class="flex-sb-m w-full p-t-3 p-b-32">
                    <div style="display: flex;">
                        <input data-val="true" data-val-required="The savelogin field is required." id="savelogin"
                            name="savelogin" type="checkbox" value="true"><input name="savelogin" type="hidden"
                            value="false">
                        <label for="savelogin" style="font-size: 13px; margin-left: 5px; cursor: pointer;">
                            Lưu đăng nhập trên thiết bị này
                        </label>
                    </div>

                    <div>
                        <a href="https://login.ueh.edu.vn/Account/ForgotPassword" class="txt1">
                            Quên mật khẩu
                        </a>
                    </div>
                </div>

                <div class="container-login100-form-btn uselocalaccount">
                    <button type="submit" class="login100-form-btn">Đăng Nhập</button>
                </div>

                <div class="text-center p-t-35 p-b-20 uselocalaccount">
                    <a id="GoogleLogin"
                        href="https://login.ueh.edu.vn/Account/GoogleLogin?returnURL=https%3A%2F%2Fueh.edu.vn%2Fdang-nhap%3FreturnUrl%3D%2Fueher&amp;savelogin=False"
                        class="txt2">
                        <div class="google-icon">
                            <svg xmlns="https://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 48 48"
                                aria-hidden="true">
                                <path fill="#4285F4"
                                    d="M45.12 24.5c0-1.56-.14-3.06-.4-4.5H24v8.51h11.84c-.51 2.75-2.06 5.08-4.39 6.64v5.52h7.11c4.16-3.83 6.56-9.47 6.56-16.17z">
                                </path>
                                <path fill="#34A853"
                                    d="M24 46c5.94 0 10.92-1.97 14.56-5.33l-7.11-5.52c-1.97 1.32-4.49 2.1-7.45 2.1-5.73 0-10.58-3.87-12.31-9.07H4.34v5.7C7.96 41.07 15.4 46 24 46z">
                                </path>
                                <path fill="#FBBC05"
                                    d="M11.69 28.18C11.25 26.86 11 25.45 11 24s.25-2.86.69-4.18v-5.7H4.34C2.85 17.09 2 20.45 2 24c0 3.55.85 6.91 2.34 9.88l7.35-5.7z">
                                </path>
                                <path fill="#EA4335"
                                    d="M24 10.75c3.23 0 6.13 1.11 8.41 3.29l6.31-6.31C34.91 4.18 29.93 2 24 2 15.4 2 7.96 6.93 4.34 14.12l7.35 5.7c1.73-5.2 6.58-9.07 12.31-9.07z">
                                </path>
                                <path fill="none" d="M2 2h44v44H2z"></path>
                            </svg>
                        </div>
                        <span>Nhấn vào đây để đăng nhập bằng Google với Email UEH</span>
                    </a>
                </div>
            </EditForm>
            <div class="login100-more" style="background-image: url(./images/bg-ueh.jpg);"></div>
        </div>
    </div>
</div>
